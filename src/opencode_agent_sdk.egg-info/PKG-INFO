Metadata-Version: 2.4
Name: opencode-agent-sdk
Version: 0.1.0
Summary: Official OpenCode Agent SDK with seamless backend switching
Author: OpenCode
License: MIT
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: anyio
Requires-Dist: httpx
Provides-Extra: claude
Requires-Dist: claude-agent-sdk; extra == "claude"
Provides-Extra: opencode
Provides-Extra: dev
Requires-Dist: pytest>=8.0; extra == "dev"

# opencode_agent_sdk

`opencode_agent_sdk` is a Python SDK that provides a **Seamless Switch** between local Claude execution and OpenCode remote runtime execution.

The goal is simple: keep one application-facing API while swapping the backend (`claude` or `opencode`) based on environment, policy, or deployment target.

## Why Seamless Switch

Teams often prototype locally with one model provider and deploy with another runtime. This SDK keeps that transition predictable by:

- standardizing request/response handling across backends
- enforcing local policy checks before tool/shell usage
- supporting hooks for observability and controls
- preserving a stable import surface for app code

## Installation

```bash
pip install opencode-agent-sdk
```

For development from source:

```bash
pip install -e .[dev]
```

Optional runtime extras:

```bash
pip install -e .[claude]
pip install -e .[opencode]
```

## Quick Start

### 1) Use backend-specific clients

```python
from opencode_agent_sdk import ClaudeAgent, OpenCodeAgent

claude = ClaudeAgent(model="claude-3-5-sonnet-latest")
result = claude.run("Summarize the current repository state")
print(result.text)

opencode = OpenCodeAgent(base_url="http://127.0.0.1:4096")
result = opencode.run("Run checks and report failures")
print(result.text)
```

### 2) Use Seamless Switch runner

```python
import asyncio
from opencode_agent_sdk.runner import run_agent

async def main() -> None:
    result = await run_agent("claude", "Review the latest commit")
    print(result.text)

asyncio.run(main())
```

Switching to OpenCode only changes the backend argument:

```python
result = await run_agent("opencode", "Review the latest commit")
```

## Import Swapping Pattern

This is the intended migration path:

- old: `from seamless_switch.runner import run_agent`
- new: `from opencode_agent_sdk.runner import run_agent`

And for direct client use:

- old: provider-specific imports in application code
- new: `from opencode_agent_sdk import ClaudeAgent, OpenCodeAgent`

## Policy and Hooks

The SDK includes:

- `Policy` for deny-list style checks (file paths, shell commands)
- `HookSet` for pre-run, pre-tool, post-run, and error callbacks
- `RunResult` as a normalized response object

Example:

```python
from opencode_agent_sdk import ClaudeAgent, HookSet, Policy

policy = Policy(deny_bash_substrings=["rm -rf", "curl | sh"])

hooks = HookSet(
    before_run=lambda prompt: print("Prompt:", prompt),
    after_run=lambda result: print("Backend:", result.backend),
)

agent = ClaudeAgent(policy=policy, hooks=hooks)
print(agent.run("List project files").text)
```

## Running Tests

```bash
PYTHONPATH=src python3 -m unittest discover -s tests -p 'test_*.py'
```

## Project Status

This repository contains a core SDK scaffold with backend adapters and safety hooks. Production deployments should still validate model/runtime contracts in their own environment.
